<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roulette</title>
        <style> 
        .spinner { 
            height: 203px;
            width: 203px; 
            border-radius: 100%; 
            background-color: transparent; 
            transform-origin: center;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
        } 
        .button {
            margin-top: 20px; 
        }
            .roulette-box {
                width: 35px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 2px;
                box-sizing: border-box;
                border: 1px solid rgba(0,0,0,0.2);
                font-size: 8px;
                font-family: Arial, Helvetica, sans-serif;
                padding: 1px;
                word-break: break-all;
                background-color: inherit;
            }
                .roulette-box.selected {
                    outline: 2px solid #222;
                    box-shadow: 0 0 4px rgba(0,0,0,0.25) inset;
                }
        body {
            text-align: center;
        }
        #topContainer {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
        }
        #spinnerContainer {
            flex-shrink: 0;
        }
        #messageContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        #betMessage {
            font-size: 16px;
            font-weight: bold;
            min-height: 30px;
        }
        </style> 

</head>
<body>
    <div id="topContainer">
        <div id="messageContainer">
            <p id="pointsDisplay">Points: <span id="pointsValue">100</span></p>
            <div>
                <label>Amount: <input id="betAmount" type="number" min="1" value="1"></label>
            </div>
            <div>
                <label>Selected: <span id="selectedChoice">None</span></label>
            </div>
            <div>
                <label>Payout: <span id="selectedPayout">-</span></label>
            </div>
            <div>
                <button id="placeBetBtn" onclick="placeBet()">Place Bet</button>
            </div>
            <p id="betMessage"></p>
        </div>
        <div id="spinnerContainer">
            <Div class="spinner" id="spinner">
                <img src="Images/363802D7-E46A-4E5E-9B11-C96A1D1F40E1_4_5005_c.jpeg" alt="roulette wheel">
            </Div>
            <div style="margin-top: 15px;">
                <button onclick="startSpin()"> 
                    Spin 
                </button> 
            </div>
        </div>
    </div>

    <div style="margin-top: 30px;">
    <!-- Column 1: 1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, Column One -->
    <div style="display: inline-block; vertical-align: top;">
        <div class="1">1</div>
        <div class="4">4</div>
        <div class="7">7</div>
        <div class="10">10</div>
        <div class="13">13</div>
        <div class="16">16</div>
        <div class="19">19</div>
        <div class="22">22</div>
        <div class="25">25</div>
        <div class="28">28</div>
        <div class="31">31</div>
        <div class="34">34</div>
        <div class="columnone">Column One</div>
    </div>

    <!-- Column 2: 0, 2, 5, 8, 11, 14, 17, 20, 23, 26, 29, 32, 35, columntwo -->
    <div style="display: inline-block; vertical-align: top; margin-left: 5px; margin-top: -39px;">
        <div class="0">0</div>
        <div class="2">2</div>
        <div class="5">5</div>
        <div class="8">8</div>
        <div class="11">11</div>
        <div class="14">14</div>
        <div class="17">17</div>
        <div class="20">20</div>
        <div class="23">23</div>
        <div class="26">26</div>
        <div class="29">29</div>
        <div class="32">32</div>
        <div class="35">35</div>
        <div class="columntwo">Column Two</div>
    </div>

    <!-- Column 3: 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, columnthree -->
    <div style="display: inline-block; vertical-align: top; margin-left: 5px;">
        <div class="3">3</div>
        <div class="6">6</div>
        <div class="9">9</div>
        <div class="12">12</div>
        <div class="15">15</div>
        <div class="18">18</div>
        <div class="21">21</div>
        <div class="24">24</div>
        <div class="27">27</div>
        <div class="30">30</div>
        <div class="33">33</div>
        <div class="36">36</div>
        <div class="columnthree">Column Three</div>
    </div>

    <!-- Special blocks grid 3x3 -->
    <div style="margin-top: 20px;">
        <div style="display: inline-block; margin-right: 10px;">
            <div class="Red">Red</div>
            <div class="Black">Black</div>
            <div class="Even">Even</div>
        </div>
        <div style="display: inline-block; margin-right: 10px;">
            <div class="Odd">Odd</div>
            <div class="Low">Low</div>
            <div class="High">High</div>
        </div>
        <div style="display: inline-block;">
            <div class="first">First Dozen</div>
            <div class="second">Second Dozen</div>
            <div class="third">Third Dozen</div>
        </div>
    </div>
    </div>
    
    <script type="text/javascript"> 
         const spinner = document.getElementById('spinner');
    let rotation = 0;
    let startTime = null;
    let animationId = null;
    let rndspdmod = 1;

    function startSpin() {
        startTime = null; 
        rndspdmod = 0.5 + Math.random(); 
        if (!animationId) animationId = requestAnimationFrame(animateSpin);
    }

    function animateSpin(timestamp) {
        if (startTime === null) startTime = timestamp;
        const lifetime = (timestamp - startTime) / 1000; 

      
        if (lifetime > 4.67) {
            animationId = null;
            displayWheelResult();
            return;
        }

       
        const spdmod = 1 / (lifetime + 0.001)+1;

        rotation += (spdmod + 10) * rndspdmod;
        spinner.style.transform = `rotate(${rotation}deg)`;

        animationId = requestAnimationFrame(animateSpin);
    }

    // Roulette wheel detector - maps wheel angle to number (0-36)
    // Standard roulette wheel order: 0, 26, 3, 35, 12, 28, 7, 29, 18, 22, 9, 31, 14, 20, 1, 33, 16, 24, 5, 10, 23, 8, 30, 11, 36, 13, 27, 6, 34, 17, 25, 2, 21, 4, 19, 15, 32
    const wheelNumbers = [0, 26, 3, 35, 12, 28, 7, 29, 18, 22, 9, 31, 14, 20, 1, 33, 16, 24, 5, 10, 23, 8, 30, 11, 36, 13, 27, 6, 34, 17, 25, 2, 21, 4, 19, 15, 32];
    
    function getWheelNumber(angle) {
        // Normalize angle to 0-360
        let normalizedAngle = ((angle % 360) + 360) % 360;
        // Each number takes up 360/37 degrees
        const degreesPerSlot = 360 / 37;
        // Determine which slot the pointer is on (assuming pointer at top, 0 degrees)
        const slotIndex = Math.round(normalizedAngle / degreesPerSlot) % 37;
        return wheelNumbers[slotIndex];
    }

    function displayWheelResult() {
        const resultNumber = getWheelNumber(rotation);
        betMessage.textContent = "Wheel Result: " + resultNumber;
        // resolve any active bet
        resolveBet(resultNumber);
        return resultNumber;
    }
   
    // Hover tracking, points and betting helpers
    let hoveredDivClass = null;
    const betMessage = document.getElementById('betMessage');
    const pointsDisplay = document.getElementById('pointsDisplay');
    const pointsValue = document.getElementById('pointsValue');
    const betAmountInput = document.getElementById('betAmount');
    const betChoiceInput = document.getElementById('betChoice'); // kept for backward compatibility (may be null)
    const selectedChoiceSpan = document.getElementById('selectedChoice');
    const selectedPayoutSpan = document.getElementById('selectedPayout');
    let selectedChoice = null; // will hold normalized internal choice string

    // simple points system
    let playerPoints = 100;
    let currentBet = null; // { amount: number, choice: string }

    function updatePointsDisplay() {
        // update numeric span so markup remains stable
        pointsValue.textContent = playerPoints;
    }

    // return an object with multiplier and label for display given an internal choice string
    function getPayoutForChoice(choice) {
        if (!choice) return { multiplier: 0, label: '-' };
        const c = choice.toLowerCase().trim();
        // straight numeric
        if (/^\d+$/.test(c)) return { multiplier: 35, label: '35:1' };
        // even money
        if (['red','black','even','odd','low','high'].includes(c)) return { multiplier: 1, label: '1:1' };
        // dozens
        if (['first','first dozen','dozen1','second','second dozen','dozen2','third','third dozen','dozen3'].includes(c)) return { multiplier: 2, label: '2:1' };
        // columns
        if (['columnone','columntwo','columnthree','col1','col2','col3','column 1','column 2','column 3'].includes(c)) return { multiplier: 2, label: '2:1' };
        return { multiplier: 0, label: '-' };
    }

    function setHoveredDivClass(className) { hoveredDivClass = className; }
    function getHoveredDivClass() { return hoveredDivClass; }

    // helper: red numbers on a standard wheel
    const redNumbers = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);

    function placeBet() {
        const amount = Number(betAmountInput.value) || 0;
        // read choice from selected box first, then fall back to legacy input if present
        const choice = (selectedChoice || (betChoiceInput ? betChoiceInput.value : '') || '').trim();
        if (!choice) { betMessage.textContent = 'Select a bet choice by clicking a box'; return; }
        if (!Number.isFinite(amount) || amount <= 0) { betMessage.textContent = 'Enter a valid bet amount'; return; }
        if (amount > playerPoints) { betMessage.textContent = 'Not enough points'; return; }
        // subtract stake immediately
        playerPoints -= amount;
        updatePointsDisplay();
        currentBet = { amount: amount, choice: choice };
        // show expected payout when bet placed
        const payoutInfo = getPayoutForChoice(choice);
        betMessage.textContent = `Bet placed: ${amount} on '${choice}' — Payout: ${payoutInfo.label}`;
    }

    function resolveBet(resultNumber) {
        if (!currentBet) return;
        const stake = currentBet.amount;
        const choiceRaw = currentBet.choice.toLowerCase();
        // French roulette rule: la partage -> even-money bets lose only half when 0 appears
        const evenMoneySet = new Set(['red','black','even','odd','low','high']);
        if (resultNumber === 0 && evenMoneySet.has(choiceRaw)) {
            // return half the stake to the player
            const returned = stake / 2;
            playerPoints += returned;
            betMessage.textContent = `Result: 0. La partage applies — half your stake (${returned}) returned. Points: ${playerPoints}`;
            // clear current bet
            currentBet = null;
            updatePointsDisplay();
            return;
        }
        let win = false;
        let profitMultiplier = 0; // profit relative to stake (e.g., 1 for even-money, 35 for straight)

        // numeric straight bet
        if (/^\d+$/.test(choiceRaw)) {
            const n = parseInt(choiceRaw, 10);
            if (n === resultNumber) { win = true; profitMultiplier = 35; }
        } else if (choiceRaw === 'red') {
            if (redNumbers.has(resultNumber)) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'black') {
            if (resultNumber !== 0 && !redNumbers.has(resultNumber)) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'even') {
            if (resultNumber !== 0 && resultNumber % 2 === 0) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'odd') {
            if (resultNumber % 2 === 1) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'low' || choiceRaw === '1-18') {
            if (resultNumber >= 1 && resultNumber <= 18) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'high' || choiceRaw === '19-36') {
            if (resultNumber >= 19 && resultNumber <= 36) { win = true; profitMultiplier = 1; }
        } else if (choiceRaw === 'first' || choiceRaw === 'first dozen' || choiceRaw === 'dozen1') {
            if (resultNumber >=1 && resultNumber <=12) { win = true; profitMultiplier = 2; }
        } else if (choiceRaw === 'second' || choiceRaw === 'second dozen' || choiceRaw === 'dozen2') {
            if (resultNumber >=13 && resultNumber <=24) { win = true; profitMultiplier = 2; }
        } else if (choiceRaw === 'third' || choiceRaw === 'third dozen' || choiceRaw === 'dozen3') {
            if (resultNumber >=25 && resultNumber <=36) { win = true; profitMultiplier = 2; }
        } else if (choiceRaw === 'columnone' || choiceRaw === 'column 1' || choiceRaw === 'col1') {
            if (resultNumber !== 0 && (resultNumber % 3) === 1) { win = true; profitMultiplier = 2; }
        } else if (choiceRaw === 'columntwo' || choiceRaw === 'column 2' || choiceRaw === 'col2') {
            if (resultNumber !== 0 && (resultNumber % 3) === 2) { win = true; profitMultiplier = 2; }
        } else if (choiceRaw === 'columnthree' || choiceRaw === 'column 3' || choiceRaw === 'col3') {
            if (resultNumber !== 0 && (resultNumber % 3) === 0) { win = true; profitMultiplier = 2; }
        }

        if (win) {
            // return stake + profit
            const payout = stake * (1 + profitMultiplier);
            playerPoints += payout;
            betMessage.textContent = `Result: ${resultNumber}. You won ${stake * profitMultiplier} (payout ${payout}).`;
        } else {
            betMessage.textContent = `Result: ${resultNumber}. You lost ${stake}.`;
        }

        // clear current bet
        currentBet = null;
        updatePointsDisplay();
    }

    updatePointsDisplay();

    const allDivs = document.querySelectorAll('div[class="0"], div[class="1"], div[class="2"], div[class="3"], div[class="4"], div[class="5"], div[class="6"], div[class="7"], div[class="8"], div[class="9"], div[class="10"], div[class="11"], div[class="12"], div[class="13"], div[class="14"], div[class="15"], div[class="16"], div[class="17"], div[class="18"], div[class="19"], div[class="20"], div[class="21"], div[class="22"], div[class="23"], div[class="24"], div[class="25"], div[class="26"], div[class="27"], div[class="28"], div[class="29"], div[class="30"], div[class="31"], div[class="32"], div[class="33"], div[class="34"], div[class="35"], div[class="36"], div.Red, div.Black, div.Even, div.Odd, div.Low, div.High, div.first, div.second, div.third, div.columnone, div.columntwo, div.columnthree');
    allDivs.forEach(div => {
            
            div.classList.add('roulette-box');

            // assign a distinct color: numbered divs get an HSL hue based on their number;
            // special named classes get fixed, meaningful colors
            const specialColors = {
                Red: '#c0392b',
                Black: '#2c3e50',
                Even: '#27ae60',
                Odd: '#e67e22',
                Low: '#9b59b6',
                High: '#f1c40f',
                first: '#1abc9c',
                second: '#3498db',
                third: '#e74c3c',
                columnone: '#95a5a6',
                columntwo: '#7f8c8d',
                columnthree: '#bdc3c7'
            };

            const cls = div.className || '';
            if (/^\d+$/.test(cls)) {
                const n = parseInt(cls, 10);
                // use a golden-angle-like distribution for hues so colors differ
                const hue = (n * 137.508) % 360;
                div.style.backgroundColor = `hsl(${hue} 65% 55%)`;
            } else if (specialColors[cls]) {
                div.style.backgroundColor = specialColors[cls];
            }

            // update hover tracking
            div.addEventListener('mouseenter', function() {
                setHoveredDivClass(this.className);
                console.log('Mouse entered div; hoveredDivClass =', getHoveredDivClass());
            });

            div.addEventListener('mouseleave', function() {
                setHoveredDivClass(null);
                console.log('Mouse left div; hoveredDivClass cleared');
            });

                // handle click to set bet choice from the clicked box
                div.addEventListener('click', function() {
                    // build a candidate list from classList, ignoring helper classes
                    const rawClasses = Array.from(this.classList || []);
                    const filtered = rawClasses.filter(c => c !== 'roulette-box' && c !== 'selected');

                    // find a canonical class: prefer numeric slot, then known keys
                    let canonical = '';
                    for (const c of filtered) { if (/^\d+$/.test(c)) { canonical = c; break; } }
                    if (!canonical) {
                        const known = ['columnone','columntwo','columnthree','first','second','third','red','black','even','odd','low','high'];
                        for (const c of filtered) { if (known.includes(c.toLowerCase())) { canonical = c.toLowerCase(); break; } }
                    }
                    if (!canonical) canonical = filtered[0] || '';

                    // map to friendly label and internal key
                    function friendlyLabelFromClass(c) {
                        if (!c) return '';
                        if (/^\d+$/.test(c)) return c;
                        const map = {
                            'columnone': 'Column 1', 'columntwo': 'Column 2', 'columnthree': 'Column 3',
                            'first': '1st dozen (1-12)', 'second': '2nd dozen (13-24)', 'third': '3rd dozen (25-36)',
                            'red': 'Red', 'black': 'Black', 'even': 'Even', 'odd': 'Odd',
                            'low': '1-18', 'high': '19-36'
                        };
                        const key = c.toLowerCase();
                        return map[key] || map[c] || c.replace(/[-_]/g,' ').replace(/(^|\s)\S/g, s => s.toUpperCase());
                    }

                    function internalChoiceFromClass(c) {
                        if (!c) return '';
                        if (/^\d+$/.test(c)) return c;
                        return c.toLowerCase();
                    }

                    const displayLabel = friendlyLabelFromClass(canonical) || (this.textContent || '').trim();
                    const choice = internalChoiceFromClass(canonical);

                    selectedChoice = choice;
                    if (selectedChoiceSpan) selectedChoiceSpan.textContent = displayLabel;
                    if (betChoiceInput) betChoiceInput.value = choice;
                    const prev = document.querySelector('.roulette-box.selected');
                    if (prev) prev.classList.remove('selected');
                    this.classList.add('selected');
                    if (selectedPayoutSpan) {
                        const pi = getPayoutForChoice(choice);
                        selectedPayoutSpan.textContent = pi.label;
                    }
                    betMessage.textContent = "Selected: '" + displayLabel + "'";
                    console.log('Clicked div classes:', rawClasses, 'canonical=', canonical, 'choice=', choice, 'label=', displayLabel);
                });
    });

    
    </script> 
</body>
</html>